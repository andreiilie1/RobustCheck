<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EpsilonGreedyUntargeted &#8212; RobustCheck  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="UntargetedAttack" href="UntargetedAttack.html" />
    <link rel="prev" title="EvoStrategyUniformUntargeted" href="EvoStrategyUniformUntargeted.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="epsilongreedyuntargeted">
<h1>EpsilonGreedyUntargeted<a class="headerlink" href="#epsilongreedyuntargeted" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robustcheck.EpsilonGreedyUntargeted.</span></span><span class="sig-name descname"><span class="pre">EpsilonGreedyUntargeted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_space_int_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_space_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_space_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted" title="Link to this definition">¶</a></dt>
<dd><p>Black-box, untargeted adversarial attack against image classifiers.</p>
<p>It encapsulates the target model and image and provides a method to run the adversarial attack. The attack
samples groups of pixels to adversarially perturb according to a classic epsilon-greedy strategy. The reward
is represented by the decrease in the probability to be classified correctly of the target image by the target
model. The attack samples a pixel from the group that provided the highest average reward so far with
probability 1-epsilon, and a pixel from a random group with probability epsilon.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.model" title="Link to this definition">¶</a></dt>
<dd><p>Target model to be attacked. This has to expose a predict method that returns the
output probability distributions when provided a batch of images as input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.img">
<span class="sig-name descname"><span class="pre">img</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.img" title="Link to this definition">¶</a></dt>
<dd><p>An array (HxWxC) representing the target image to be perturbed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.label" title="Link to this definition">¶</a></dt>
<dd><p>An integer representing the correct class index of the image.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.pixel_groups">
<span class="sig-name descname"><span class="pre">pixel_groups</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.pixel_groups" title="Link to this definition">¶</a></dt>
<dd><p>An array of arrays of pairs of integers. Each second level array represents the indices of pixels
that get attacked as part of the same pixel group. Usual approaches are to have these groups created based
on objectness or on spatial proximity (e.g. in a grid-like setup).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.epsilon">
<span class="sig-name descname"><span class="pre">epsilon</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.epsilon" title="Link to this definition">¶</a></dt>
<dd><p>A float representing the probability of exploration (choosing a random group of pixels to be perturbed)
in the classic epsilon-greedy strategy.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.pixel_space_max">
<span class="sig-name descname"><span class="pre">pixel_space_max</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.pixel_space_max" title="Link to this definition">¶</a></dt>
<dd><p>A number (integer or float) representing the maximum value pixels can take in the image space.
This is used for extracting normalised metrics about the attack success later on.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.verbose" title="Link to this definition">¶</a></dt>
<dd><p>A boolean flag which, when set to True, enables printing info on the attack results.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.get_best_candidate">
<span class="sig-name descname"><span class="pre">get_best_candidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.get_best_candidate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.get_best_candidate" title="Link to this definition">¶</a></dt>
<dd><p>Returns the fittest individual in the active generation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.is_perturbed">
<span class="sig-name descname"><span class="pre">is_perturbed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.is_perturbed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.is_perturbed" title="Link to this definition">¶</a></dt>
<dd><p>Returns a boolean representing whether a successful adversarial perturbation has been
achieved in the active generation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.run_adversarial_attack">
<span class="sig-name descname"><span class="pre">run_adversarial_attack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.run_adversarial_attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.run_adversarial_attack" title="Link to this definition">¶</a></dt>
<dd><p>Runs the adversarial attack based on the evolutionary strategy until a
successful adversarial perturbation was found or until steps generations were explored. Returns the total
number of generations before the stopping condition was reached.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.explore_attack_group">
<span class="sig-name descname"><span class="pre">explore_attack_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.explore_attack_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.explore_attack_group" title="Link to this definition">¶</a></dt>
<dd><p>Explores the potential reward obtained by sampling the attacked pixel from a fixed group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>group_index</strong> – An integer representing the index of the pixel group that the method will attempt perturbing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary containing information about the perturbation attempt. The dictionary contains the following
fields:</p>
<blockquote>
<div><p>”potential_reward”: A float representing the expected reward by perturbing the target group.
“altered_image”: A three-dimensional array representing the perturbed image after applying the</p>
<blockquote>
<div><p>group_index group perturbation.</p>
</div></blockquote>
<dl class="simple">
<dt>”prob_before”: A float representing the probability of the perturbed image to be classified correctly</dt><dd><p>by the target model before applying the group_index group perturbation.</p>
</dd>
<dt>”prob_after”: A float representing the probability of the perturbed image to be classified correctly</dt><dd><p>by the target model after applying the group_index group perturbation.</p>
</dd>
<dt>”pred_after”: An array of floats representing the probability distribution of the perturbed image as</dt><dd><p>output by the target model after applying the group_index group perturbation.</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">is_perturbed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.is_perturbed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean representing whether the adversarial attack has been successful</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">run_adversarial_attack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.run_adversarial_attack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Runs the adversarial attack.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An integer representing the number of attack steps until either the attack was successful or the maximum
steps threshold was reached.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.select_group">
<span class="sig-name descname"><span class="pre">select_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.select_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.select_group" title="Link to this definition">¶</a></dt>
<dd><p>This is the core method that trades off between exploration and exploitation, as expected in classic
epsilon-greedy strategies. Here, exploration is represented by sampling a random group of pixels, while
exploitation means selecting a group of pixels with the highest average reward observed so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chosen_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/robustcheck/EpsilonGreedyUntargeted/EpsilonGreedyUntargeted.html#EpsilonGreedyUntargeted.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#robustcheck.EpsilonGreedyUntargeted.EpsilonGreedyUntargeted.update" title="Link to this definition">¶</a></dt>
<dd><p>Updates a pixel group chosen_group according to an observed reward. This will update the corresponding
group value and count of historical observation. This updates the instance fields _values and _counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chosen_group</strong> – An integer representing the index of the pixel group that will get updated after a new reward
was observed.</p></li>
<li><p><strong>reward</strong> – The reward used to update the pixel group value and count.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A float representing the updated value of the historical average reward of the chosen group.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">RobustCheck</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Main content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Robustness metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="RobustnessCheck.html">RobustnessCheck API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dump_metrics.html">Dumping robustness check results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Adversarial attacks documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="EvoStrategyUniformUntargeted.html">EvoStrategyUniformUntargeted</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">EpsilonGreedyUntargeted</a></li>
<li class="toctree-l1"><a class="reference internal" href="UntargetedAttack.html">UntargetedAttack</a></li>
<li class="toctree-l1"><a class="reference internal" href="EvoStrategy.html">EvoStrategy</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="EvoStrategyUniformUntargeted.html" title="previous chapter">EvoStrategyUniformUntargeted</a></li>
      <li>Next: <a href="UntargetedAttack.html" title="next chapter">UntargetedAttack</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Andrei Ilie.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/EpsilonGreedyUntargeted.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>